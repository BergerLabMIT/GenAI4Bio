<div class="theme-toggle-wrap">
  <button id="theme-toggle" class="btn theme-toggle" type="button">Toggle theme</button>
</div>

<script>
(function() {
  var storageKey = 'jtd-theme';
  var darkLink = document.getElementById('jtd-dark-theme');
  var btn = document.getElementById('theme-toggle');
  if (!btn || !darkLink) return;

  function setTheme(mode) {
    var isDark = mode === 'dark';
    darkLink.disabled = !isDark;
    if (isDark) {
      document.documentElement.setAttribute('data-theme', 'dark');
    } else {
      document.documentElement.removeAttribute('data-theme');
    }
    btn.textContent = isDark ? 'Light mode' : 'Dark mode';
    localStorage.setItem(storageKey, mode);
  }

  var stored = localStorage.getItem(storageKey);
  var preferred = stored ? stored : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  setTheme(preferred);

  btn.addEventListener('click', function() {
    var isDark = !darkLink.disabled;
    setTheme(isDark ? 'light' : 'dark');
  });
})();
</script>
